<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="author" content="Will Price">
    <meta name="description" content="">
    <link href="http://feeds.feedburner.com/willpriceblog" type="application/atom+xml" title="Will Price" rel="alternative"/>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/skeleton.css">
    <link rel="stylesheet" href="/css/pygments.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Slab">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/user.css">

    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="/scripts/toc.js"></script>
    <script src="/scripts/ganalytics.js"></script>
    
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="title">
        <a href="/">Will Price</a>
        <a class="extra" href="/">Posts</a>
        <!-- Notes need more cleaning up before being visible for
             browsing!
        <a class="extra" href="/notes">Notes</a>
        -->
        <a class="extra" href="/about.html">About</a>
        <hr />
      </div>
      <section>
        <h1 id="sensing-the-world-around-you">Sensing the world around you!</h1>
<p>Our robot is equipped with two types of sensors:</p>

<ol>
  <li>1 x InfraRed (IR) distance sensor.</li>
  <li>3 x Line following sensors.</li>
</ol>

<p>We’ll be using just the first today. I haven’t used the line following sensors
yet so there are no functions to use them in the <code class="highlighter-rouge">DFRduino</code> library. To measure
the distance we can use the <code class="highlighter-rouge">readDistanceInCentimeters()</code> function, can you
guess what it does…?</p>

<p>Ha… here’s an example:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;Servo.h&gt;
#include &lt;DFRduino.h&gt;
</span>

<span class="n">DFRduino</span> <span class="n">robot</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Print the distance sensed by the IR sensor
</span>  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Distance: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">robot</span><span class="p">.</span><span class="n">readDistanceInCentimeters</span><span class="p">());</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"cm"</span><span class="p">);</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>Pick your robot up and point it’s eyes (the IR sensor) at some stuff, see how
far, and how close it measure. Notice what happens when you move your hand too
close to the sensor, what happens to the distance read?</p>

<p>The IR sensor works by pulsing a infra red light then waiting to see how long it
takes to bounce of a surface and be read by the infra red sensor. Can you
explain what happens when you cover up the left hand side of the sensor?</p>

<p>Our goal at the end of the workshop is for you to have built an obstacle
avoiding robot. Let’s have a look at how we can move depending on the distance
read by the sensor:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;Servo.h&gt;
#include &lt;DFRduino.h&gt;
</span>

<span class="n">DFRduino</span> <span class="n">robot</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Providing there are no delays in our code, this loop is being run
</span>  <span class="c1">// thousands of times a second. Think about how that might affect the
</span>  <span class="c1">// code you write
</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">robot</span><span class="p">.</span><span class="n">readDistanceInCentimeters</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Go back for 1 second
</span>    <span class="n">robot</span><span class="p">.</span><span class="n">setDirection</span><span class="p">(</span><span class="sc">'b'</span><span class="p">);</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="c1">// Turn right by approximately 90 degrees
</span>    <span class="n">robot</span><span class="p">.</span><span class="n">setDirection</span><span class="p">(</span><span class="sc">'r'</span><span class="p">);</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Otherwise we'll just go forward 
</span>    <span class="n">robot</span><span class="p">.</span><span class="n">setDirection</span><span class="p">(</span><span class="sc">'f'</span><span class="p">);</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Surprisingly, at least in my room this is a relatively effective tactic, in
fact, it’s even better than some considerably more complex code I wrote! But
we’ll look at the complicated code anyway, so you can show me how I was doing it
wrong all along! The method of going back for a second, then turning 90 degrees
right is called a <em>heuristic</em>. A <em>heuristic</em> is a way of solving a problem, it
will not give you the optimal solution (notice how the robot will not see things
below it’s line of sight, like a pen, and will crash into them), but it will
give you a reasonable solution none the less. I’m sure you can develop a
heuristic that is superior to this demo. Go have a go doing that now…</p>

<p>… or if you’re more interested in making your robot’s head move, then move on
to the next section: <a href="nodding.html"><strong>nodding</strong></a></p>

      </section>
    </div>

    <script type="text/javascript">
      $(document).ready(function() {
        $('.toc').toc();
      });
    </script>
  </body>
</html>
