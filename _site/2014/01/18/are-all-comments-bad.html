<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Are all comments bad?</title>
    <meta name="author" content="Will Price">
    <meta name="description" content="">
    <link href="http://feeds.feedburner.com/willpriceblog" type="application/atom+xml" title="Will Price" rel="alternative"/>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/skeleton.css">
    <link rel="stylesheet" href="/css/pygments.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto+Slab">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/user.css">

    <link rel="shortcut icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">

    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="/scripts/toc.js"></script>
    <script src="/scripts/ganalytics.js"></script>
    
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="title">
        <a href="/">Will Price</a>
        <a class="extra" href="/">Posts</a>
        <!-- Notes need more cleaning up before being visible for
             browsing!
        <a class="extra" href="/notes">Notes</a>
        -->
        <a class="extra" href="/about.html">About</a>
        <hr />
      </div>
      <section>
        <div class="content">
    <div id="post">
        <h1>Are all comments bad?</h1>
        
        <p>I’ve been thinking about comments in code. Some people advocate not using
comments suggesting that your code should be self documenting. I believe this to
be a good practice where possible. If you need comments to explain what your
code is doing, then it’s quite likely you’re code isn’t sufficiently broken down
into lots of little methods naming what each part does. What happens when you
have code that is simply non-intuitive and breaking it out into named methods
doesn’t work?</p>

<p>Let’s look at an example to emphasize my point. We’ll take the naive Fibonacci
function:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">unittest</span>


<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_base_case</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_base_case</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>


<span class="k">class</span> <span class="nc">FibonacciTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_first_fib_number_is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_second_fib_number_is_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_third_fib_number_is_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_fourth_fib_number_is_two</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sixth_fib_number_is_five</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></figure>

<p>Now for a tail recursive implementation that is more efficient (but not in
Python, as it doesn’t have tail call optimization! I should have done it in C,
but I couldn’t face writing the tests using <code class="highlighter-rouge">check</code>).</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">unittest</span>


<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fib_accumulator</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fib_accumulator</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">nth_fib</span><span class="p">,</span> <span class="n">nth_minus_one_fib</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nth_minus_one_fib</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nth_fib</span>

    <span class="n">next_fib</span> <span class="o">=</span> <span class="n">nth_fib</span> <span class="o">+</span> <span class="n">nth_minus_one_fib</span>
    <span class="k">return</span> <span class="n">fib_accumulator</span><span class="p">(</span><span class="n">counter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">next_fib</span><span class="p">,</span> <span class="n">nth_fib</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">FibonacciTests</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_first_fib_number_is_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_second_fib_number_is_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_third_fib_number_is_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_fourth_fib_number_is_two</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_sixth_fib_number_is_five</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span></code></pre></figure>

<p>I’ve tried my best to make this as self-explanatory as possible. I still feel
that additional explanation would help for whoever has to maintain it. The first
time I saw this definition <code class="highlighter-rouge">nth_fib</code> was <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">nth_minus_one_fib</code> was <code class="highlighter-rouge">b</code>, I
had absolutely no idea how it worked. Naming things really makes such a
difference!</p>

<p>The additional information I’d like to add is:</p>

<ul>
  <li>We only return <code class="highlighter-rouge">nth_minus_one</code> if <code class="highlighter-rouge">counter == 1</code>, which implies we’re calling
<code class="highlighter-rouge">fib(1)</code> so we return the first fibonacci number: 0.</li>
  <li>When <code class="highlighter-rouge">n &gt; 1</code> then <code class="highlighter-rouge">counter == 2</code> terminates the algorithm returning the
accumulated value</li>
  <li>
    <p>A few examples:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>  fib(3) -&gt; fib_accumulator(3, 1, 0) -&gt; fib_accumulator(2, (1 + 0), 1) -&gt; return (1 + 0)

  fib(5) -&gt; fib_accumulator(5, 1, 0) -&gt; fib_accumulator(4, (1 + 0), 1) -&gt; 
            fib_accumulator(3, (1 + 0 + 1), (1 + 0)) -&gt; fib_accumulator(2, (1 +
            0 + 1 + 1 + 0), (0 + 1 + 1)) -&gt; return (1 + 0 + 1 + 1 + 0) -&gt; return 3
</code></pre>
    </div>
  </li>
</ul>

<p>I think that information makes it clearer how the function works. I tried to
extract the base cases to add more explanation via code, but couldn’t think of
descriptive enough methods, maybe that’s because I don’t grok the algorithm. I
can see how it works, but find it very hard to articulate how to explain it’s
behaviour, when this happens I find it’s best to resort to examples to guide
explanation, but this is difficult to do in code! Unit tests you scream!? True,
maybe I should add comments there explaining what is happening? How do you
handle cases where you feel your code isn’t sufficiently descriptive, but can’t
make it more descriptive through refactoring?</p>

    </div>
</div>

      </section>
    </div>

    <script type="text/javascript">
      $(document).ready(function() {
        $('.toc').toc();
      });
    </script>
  </body>
</html>
